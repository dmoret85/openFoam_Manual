# Chapter 8 — Numerics and Stability

## 8.1 Numerical Stability as an Engineering Requirement

Numerical stability is not a secondary concern or a solver-specific technicality. It is a prerequisite for producing physically meaningful CFD results. A simulation that is numerically unstable may diverge immediately, oscillate indefinitely, or converge smoothly to an incorrect solution.

In OpenFOAM, numerical stability depends on the interaction between time integration, spatial discretization, solver settings, and mesh quality. Stability cannot be enforced by a single parameter; it must be designed into the case.

Numerical stability concerns whether the discrete equations remain well posed and bounded. Numerical accuracy concerns how closely the discrete solution approximates the continuous equations. A solution can be stable but inaccurate, but it cannot be accurate if it is unstable.

Mesh-related contributors to instability are discussed in Section 04.2 — Mesh Quality Metrics.

---

## 8.2 Time Integration and Time-Step Selection

Most engineering simulations in OpenFOAM are transient, even when a statistically steady solution is desired. The time step controls how information propagates through the domain and strongly influences stability.

A key non-dimensional parameter is the Courant–Friedrichs–Lewy (CFL) number:

\[
\mathrm{Co} = \frac{u \Delta t}{\Delta x}
\]

where \(u\) is the local velocity magnitude, \(\Delta t\) the time step, and \(\Delta x\) the local cell size.

In practical simulations, the CFL number varies spatially. Stability is governed by the maximum local CFL, not by a domain-averaged value.

General guidance:
- Explicit or semi-explicit schemes: \(\mathrm{Co} \lesssim 1\)
- VOF simulations: \(\mathrm{Co} \lesssim 0.5\)
- Highly transient flows: \(\mathrm{Co} \ll 1\)

Automatic time-step control using `adjustTimeStep` is strongly recommended for transient cases.

---

## 8.3 Spatial Discretization and `fvSchemes`

Spatial discretization choices directly affect numerical diffusion, boundedness, and stability.

Key principles:
- First-order schemes are stable but overly diffusive
- Higher-order schemes reduce diffusion but require better mesh quality
- Bounded schemes are essential for transported scalars and volume fractions

Typical engineering practice is to begin with conservative, bounded schemes and increase accuracy only after stability is demonstrated.

Higher-order schemes amplify mesh defects such as skewness and non-orthogonality. For this reason, discretization order should be increased only after mesh quality and baseline stability have been demonstrated.

Boundedness requirements are particularly important for turbulence variables (Chapter 6) and volume fractions in multiphase flows.

---

## 8.4 Pressure–Velocity Coupling

OpenFOAM’s segregated solvers rely on pressure–velocity coupling algorithms such as SIMPLE, PISO, and PIMPLE.

Key considerations:
- SIMPLE is suited for steady-state problems
- PISO is efficient for transient flows with small time steps
- PIMPLE blends SIMPLE and PISO and is robust for general transient simulations

Under-relaxation and corrector settings must be chosen consistently with time step and mesh resolution.

### Coupling Sensitivity and Boundary Conditions

Pressure–velocity coupling behavior is strongly influenced by outlet boundary conditions and mesh quality near pressure reference locations.

Poor outlet placement or inconsistent boundary conditions can lead to:
- pressure oscillations
- slow convergence
- artificial recirculation

Guidance on outlet boundary conditions is provided in Section 07.3 — Outlets.

Increasing the number of correctors cannot compensate for inconsistent boundary conditions or poor mesh quality.

---

## 8.5 Linear Solvers and Tolerances

Linear solver settings influence convergence behavior but do not fix fundamental modeling or discretization errors.

Important points:
- Tight tolerances do not guarantee physical correctness
- Excessively loose tolerances mask instability
- Solver choice should reflect matrix symmetry and conditioning

Residuals should be interpreted as numerical indicators, not physical error measures.

Linear solver settings control how the algebraic system is solved; they do not change the underlying mathematical model.

---

## 8.6 Residuals, Convergence, and Physical Monitoring

Residual convergence alone is insufficient to assess solution quality.

Good practice includes monitoring:
- Integral quantities (forces, mass flow rates)
- Local probes and profiles
- Time histories of key variables

A solution is acceptable only when numerical convergence aligns with physical consistency.

Residuals measure algebraic convergence of the discretized equations; monitored physical quantities reflect solution behavior. Both are required.

---

## 8.7 Common Numerical Failure Modes

Typical numerical failure modes include:
- Time-step–induced divergence
- Pressure oscillations due to poor coupling
- Unbounded scalars or volume fractions
- False convergence caused by excessive relaxation

These issues often manifest before solver failure and should be treated as early warning signs.

Detailed diagnosis of numerical failure modes is discussed in Chapter 12 — Debugging and Failure Modes.

---

## 8.8 Stabilization Strategies

Effective stabilization strategies include:
- Reducing time step or CFL limit
- Increasing numerical diffusion selectively
- Improving mesh quality in critical regions
- Adjusting pressure–velocity coupling parameters

Stabilization should be applied methodically, with physical implications considered at each step.

Stabilization should precede any attempt to improve accuracy.

---

## 8.9 Engineering Checklist

Before trusting a solution:
- Verify CFL numbers throughout the domain
- Confirm boundedness of transported fields
- Check sensitivity to time step and discretization
- Ensure monitored physical quantities are stable

Numerical stability is not an obstacle to accuracy; it is the foundation upon which accuracy is built.

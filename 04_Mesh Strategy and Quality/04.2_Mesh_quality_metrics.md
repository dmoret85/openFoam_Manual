# Section 04.2 — Mesh Quality Metrics

Mesh quality has a direct impact on the accuracy, stability, and robustness of finite-volume CFD simulations. In OpenFOAM, mesh quality is evaluated using a set of geometric metrics accessible through the `checkMesh` utility.

These metrics should not be interpreted as strict pass/fail criteria. Instead, they act as **risk indicators**, highlighting regions where discretization errors, numerical diffusion, or instability are more likely to occur.

The most important mesh quality metrics are:
- Non-orthogonality
- Skewness
- Aspect ratio
- Cell volume variation

---

## 04.2.1 Non-Orthogonality


::contentReference[oaicite:0]{index=0}


### Definition  
Non-orthogonality measures the angle between the face normal vector and the vector connecting the centers of adjacent cells. In an ideal finite-volume mesh, these vectors are aligned.

### Why it matters  
High non-orthogonality degrades:
- Gradient reconstruction accuracy  
- Pressure–velocity coupling  
- Stability of higher-order discretization schemes  

OpenFOAM can partially compensate using **corrected gradient and Laplacian schemes**, but this introduces additional numerical diffusion and computational cost.

### Engineering interpretation  
- Moderate non-orthogonality is often unavoidable in complex geometries  
- High non-orthogonality is especially problematic near:
  - walls
  - shear layers
  - free surfaces

### Typical symptoms  
- Slow or oscillatory convergence  
- Pressure checkerboarding  
- Sensitivity to `nNonOrthogonalCorrectors`

---

## 04.2.2 Skewness


::contentReference[oaicite:1]{index=1}


### Definition  
Skewness measures how far a face center deviates from the line connecting adjacent cell centers. Highly skewed cells distort face-based interpolation.

### Why it matters  
High skewness affects:
- Accuracy of convective fluxes  
- Boundedness of transported scalars  
- Stability of higher-order schemes  

Skewness is often more damaging than non-orthogonality for convection-dominated flows.

### Engineering interpretation  
Skewness is particularly critical for:
- turbulence quantities (`k`, `omega`, `nuTilda`)  
- scalar transport  
- volume fraction transport in VOF simulations  

Even meshes with acceptable non-orthogonality can fail if skewness is excessive.

### Typical symptoms  
- Unbounded scalar fields  
- Spurious oscillations  
- Smooth but physically incorrect solutions

---

## 04.2.3 Aspect Ratio


::contentReference[oaicite:2]{index=2}


### Definition  
Aspect ratio is the ratio between the longest and shortest dimensions of a cell.

### Why it matters  
High aspect ratio cells are **not inherently bad** and are often required in boundary-layer meshes. Problems arise when:
- cells are poorly aligned with the flow direction  
- large aspect ratios coexist with high skewness or non-orthogonality  
- transitions between stretched and isotropic cells are abrupt  

### Engineering interpretation  
- Boundary layers often require aspect ratios >> 100  
- Aspect ratio must be evaluated **together with orientation and smoothness**

### Typical symptoms  
- Excessive numerical diffusion  
- Poor resolution of shear stresses  
- Under-prediction of wall friction or separation behavior

---

## 04.2.4 Cell Volume Variation


::contentReference[oaicite:3]{index=3}


### Definition  
Cell volume variation measures the change in cell size between neighboring cells.

### Why it matters  
Large volume jumps introduce:
- Numerical stiffness  
- Increased truncation error  
- Sensitivity to time-step size  

These effects are particularly problematic in transient simulations.

### Engineering interpretation  
Gradual transitions in cell size are essential in:
- boundary-layer regions  
- wake refinement zones  
- locally refined meshes  

Abrupt refinement interfaces should be avoided whenever possible.

### Typical symptoms  
- Sudden reduction of allowable time step  
- Artificial pressure reflections  
- Poor convergence despite acceptable residuals

---

## 04.2.5 Interpreting `checkMesh` Results

The limits reported by `checkMesh` should be interpreted as **risk indicators**, not absolute acceptance criteria.

A mesh that technically “passes” `checkMesh` may still be unreliable if:
- poor-quality cells are located in physically important regions  
- aggressive numerical schemes are used  
- turbulence or multiphase models are sensitive to local discretization errors  

Conversely, a mesh with localized quality issues may still be acceptable if:
- problematic cells are confined to low-impact regions  
- conservative discretization schemes are used  
- results are carefully verified  

Mesh quality must always be assessed **in combination with physics, numerics, and verification results**.

---

## 04.2.6 Summary Table

| Metric | Visual cue | Primary numerical risk | Common symptom |
|------|-----------|------------------------|----------------|
| Non-orthogonality | Tilted faces | Gradient error | Pressure noise |
| Skewness | Shifted face centers | Flux error | Unbounded scalars |
| Aspect ratio | Thin stretched cells | Numerical diffusion | Poor shear prediction |
| Volume variation | Abrupt size jumps | Numerical stiffness | Time-step collapse |

---

## Engineering Rule

> **Mesh quality metrics indicate numerical risk, not solution validity.**

A mesh is acceptable only if:
- quality issues are understood
- numerical behavior is stable
- results are verified and physically consistent

